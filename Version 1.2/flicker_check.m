% flicker_check.mfunction flicker_checkw = SCREEN(0,'OpenWindow',0);stim = grating_stim(600,1,32);bits = ScreenDacBits(0);GMAX = 0.025;grey = GMAX * (0:255) * (2^bits - 1) / 255;grey = repmat(grey', 1,3);grey2 = flipud(grey);LoadClut(w,grey);SCREEN(w,'PutImage',stim);FlushEvents('KeyDown');x = 1;while 1	[KeyIsDown secs KeyCode] = KbCheck;	if KeyIsDown		break;	end	SCREEN(w,'WaitBlanking',15);	if x == 0		LoadClut(w,grey);	else		LoadClut(w,grey2);	end	x = 1-x;endSCREEN('CloseAll');return% grating_stim% ... creates n x n image% ... containing vertical grating% ...function stimulus = grating_stim(n,contrast,period)wave = sine_wave(n,period);stimulus = 128 + 127 * contrast * repmat(wave, n,1);% stimulus = stimulus';returnfunction wave = sine_wave(n,period)wave = sin(2*pi*(rand + (1:n)/period));returnfunction wave = square_wave(n,period)s = sign(sine_wave(4*n,4*period));wave = zeros(1,n);for i = 1:n	wave(i) = sum(s((i-1)*4+(1:4)))/4;endreturn